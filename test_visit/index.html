<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Service Visit</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        .service-list {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
        }
        .service {
            border: 1px solid #ccc;
            padding: 20px;
            width: 300px;
            text-align: center;
            position: relative;
        }
        .layer {
            position: relative;
        }
        .mark-visited-btn {
            margin-top: 10px;
            padding: 10px;
            background-color: #4CAF50;
            color: white;
            border: none;
            cursor: pointer;
        }
        .mark-visited-btn:hover {
            background-color: #45a049;
        }
        .visit-info {
            margin-top: 10px;
            color: #555;
            font-size: 14px;
            display: none;
        }
    </style>
</head>
<body>

<div id="about-resort-img">
    <div class="container">
        <h1 class="sub-title">Resort</h1>
        <div class="service-list">
            <div class="service" data-service-id="456">
                <img src="/HoChiMinh/villa.jpg" alt="Villa S√¥ng">
                <div class="layer">
                    <h3>Villa S√¥ng</h3>
                    <a href="https://villasong.com/"><i class="fa-solid fa-up-right-from-square"></i></a>
                    <div class="popular__rating">
                        <span><i class="ri-star-fill"></i></span>
                        3.0(2200) üòä
                    </div>
                    <!-- N√∫t ƒë√°nh d·∫•u l√† ƒë√£ gh√© thƒÉm -->
                    <button class="mark-visited-btn">Mark as Visited</button>
                    <!-- Hi·ªÉn th·ªã ng√†y gi·ªù khi nh·∫•n n√∫t -->
                    <div class="visit-info" style="display: none;"></div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    document.addEventListener("DOMContentLoaded", () => {
        const markVisitedButtons = document.querySelectorAll('.mark-visited-btn');
        
        markVisitedButtons.forEach(button => {
            button.addEventListener('click', async (e) => {
                const serviceElement = e.target.closest('.service');
                const serviceId = serviceElement.getAttribute('data-service-id');
                const visitInfoDiv = serviceElement.querySelector('.visit-info');
                
                // Hi·ªÉn th·ªã ng√†y gi·ªù hi·ªán t·∫°i
                const currentDate = new Date();
                visitInfoDiv.style.display = 'block';
                visitInfoDiv.innerHTML = `Visited at: ${currentDate.toLocaleString()}`;

                // G·ªçi API ƒë·ªÉ th√™m visit
                try {
                    const response = await fetch(`/api/services/${serviceId}/visit`, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            // B·∫°n c√≥ th·ªÉ th√™m c√°c th√¥ng tin nh∆∞ userId v√†o ƒë√¢y n·∫øu c·∫ßn
                            // userId: 1
                        })
                    });

                    if (response.ok) {
                        console.log('Visit added successfully');
                        // B·∫°n c√≥ th·ªÉ hi·ªÉn th·ªã th√¥ng b√°o th√†nh c√¥ng n·∫øu c·∫ßn
                    } else {
                        console.error('Failed to add visit');
                        // Hi·ªÉn th·ªã th√¥ng b√°o l·ªói cho ng∆∞·ªùi d√πng n·∫øu c·∫ßn
                    }
                } catch (error) {
                    console.error('Error occurred while adding visit:', error);
                    // Hi·ªÉn th·ªã th√¥ng b√°o l·ªói n·∫øu c√≥ l·ªói k·∫øt n·ªëi
                }
            });
        });
    });
</script>

</body>
</html>
